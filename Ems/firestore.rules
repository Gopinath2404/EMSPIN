rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Employee collection
    match /employees/{employeeId} {
      allow read: if request.auth != null; // Allow logged-in users to read
      allow write: if request.auth.token.role == "admin"; // Only admins can write
    }

    // Attendance collection
    match /attendance/{docId} {
      allow read, create: if request.auth != null;
      allow update, delete: if request.auth.token.role == "admin";
    }

    // Leaves collection
    match /leaves/{leaveId} {
      allow read: if request.auth != null;
      allow create: if request.auth != null; // Employee can apply for leave
      allow update, delete: if request.auth.token.role == "admin"; // Only admin can update or delete
    }

    // Default rule - Deny everything else
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
